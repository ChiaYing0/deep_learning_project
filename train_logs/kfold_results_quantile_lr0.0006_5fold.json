{
  "config": {
    "mm_model_dim": 512,
    "mm_model_num_layers": 3,
    "mm_model_num_heads": 4,
    "train_csv": "./data/train_robust.csv",
    "val_csv": "./data/val_robust.csv",
    "test_csv": "./data/test_robust.csv",
    "image_dir": "./images/",
    "shap_feature": "./shap_feature_ranking.csv",
    "use_log": true,
    "loss_type": "quantile",
    "lr": 0.0006,
    "epochs": 100,
    "regular_epochs": 40,
    "batch_size": 40,
    "weight_decay": 0.02,
    "n_splits": 5,
    "patience": 15,
    "huber_beta": 10.0,
    "quantile_q": 0.7,
    "asymmetric_alpha": 1.5,
    "use_shap": false,
    "meta_input_dim": 51,
    "meta_intput_dim_shap": 20,
    "meta_hidden_dims": [
      256,
      512,
      256
    ],
    "meta_embedding_dim": 128,
    "meta_dropout": 0.05,
    "meta_encoder_ckpt": "meta/meta_encoder.pth",
    "meta_pretrain": false,
    "freeze_img_net": false,
    "freeze_img_layers": [
      "conv1",
      "bn1",
      "layer1",
      "layer2",
      "layer3"
    ]
  },
  "k_fold_results": {
    "n_splits": 5,
    "mean_val_loss": 0.2944191858172417,
    "std_val_loss": 0.025205667415387954,
    "fold_losses": [
      0.30798909068107605,
      0.3162752836942673,
      0.31020519509911537,
      0.2469698302447796,
      0.29065652936697006
    ]
  },
  "fold_details": [
    {
      "fold": 1,
      "best_val_loss": 0.30798909068107605,
      "history": [
        {
          "epoch": 1,
          "train_loss": 0.8653285463651021,
          "val_loss": 0.3186303675174713
        },
        {
          "epoch": 2,
          "train_loss": 0.35354819198449455,
          "val_loss": 0.33435170352458954
        },
        {
          "epoch": 3,
          "train_loss": 0.33611425856749216,
          "val_loss": 0.3417951464653015
        },
        {
          "epoch": 4,
          "train_loss": 0.3369779427846273,
          "val_loss": 0.3095514178276062
        },
        {
          "epoch": 5,
          "train_loss": 0.34447628060976665,
          "val_loss": 0.3117443695664406
        },
        {
          "epoch": 6,
          "train_loss": 0.3120903233687083,
          "val_loss": 0.30798909068107605
        },
        {
          "epoch": 7,
          "train_loss": 0.31194047729174296,
          "val_loss": 0.31338343769311905
        },
        {
          "epoch": 8,
          "train_loss": 0.34704016844431557,
          "val_loss": 0.3221634328365326
        },
        {
          "epoch": 9,
          "train_loss": 0.3218537559111913,
          "val_loss": 0.3281833902001381
        },
        {
          "epoch": 10,
          "train_loss": 0.3049230396747589,
          "val_loss": 0.4056112766265869
        },
        {
          "epoch": 11,
          "train_loss": 0.31692462265491483,
          "val_loss": 0.3158811256289482
        },
        {
          "epoch": 12,
          "train_loss": 0.309611389040947,
          "val_loss": 0.3082173392176628
        },
        {
          "epoch": 13,
          "train_loss": 0.29598646660645805,
          "val_loss": 0.30799031257629395
        },
        {
          "epoch": 14,
          "train_loss": 0.30275649031003316,
          "val_loss": 0.8841895461082458
        },
        {
          "epoch": 15,
          "train_loss": 0.29014844795068107,
          "val_loss": 0.31351998448371887
        },
        {
          "epoch": 16,
          "train_loss": 0.2858775089184443,
          "val_loss": 0.31041956692934036
        },
        {
          "epoch": 17,
          "train_loss": 0.2791788727045059,
          "val_loss": 0.32026875764131546
        },
        {
          "epoch": 18,
          "train_loss": 0.296517813205719,
          "val_loss": 0.32329875230789185
        },
        {
          "epoch": 19,
          "train_loss": 0.28595083852609,
          "val_loss": 0.3193811848759651
        },
        {
          "epoch": 20,
          "train_loss": 0.28112132449944816,
          "val_loss": 0.31270550936460495
        },
        {
          "epoch": 21,
          "train_loss": 0.2723740388949712,
          "val_loss": 0.31531357020139694
        }
      ],
      "model_path": "kfold_models\\fold_1_model_0.3080.pt"
    },
    {
      "fold": 2,
      "best_val_loss": 0.3162752836942673,
      "history": [
        {
          "epoch": 1,
          "train_loss": 1.289839369058609,
          "val_loss": 0.40984492748975754
        },
        {
          "epoch": 2,
          "train_loss": 0.35724585354328153,
          "val_loss": 0.3344365209341049
        },
        {
          "epoch": 3,
          "train_loss": 0.33599552512168884,
          "val_loss": 0.3346919044852257
        },
        {
          "epoch": 4,
          "train_loss": 0.3438040812810262,
          "val_loss": 0.3318507671356201
        },
        {
          "epoch": 5,
          "train_loss": 0.3354592859745026,
          "val_loss": 0.3302561864256859
        },
        {
          "epoch": 6,
          "train_loss": 0.3205073138078054,
          "val_loss": 0.32404644787311554
        },
        {
          "epoch": 7,
          "train_loss": 0.32052528063456215,
          "val_loss": 0.33203787356615067
        },
        {
          "epoch": 8,
          "train_loss": 0.32082950075467426,
          "val_loss": 0.33402589708566666
        },
        {
          "epoch": 9,
          "train_loss": 0.31528154015541077,
          "val_loss": 0.3235132619738579
        },
        {
          "epoch": 10,
          "train_loss": 0.33565152287483213,
          "val_loss": 0.36803919821977615
        },
        {
          "epoch": 11,
          "train_loss": 0.3220808585484823,
          "val_loss": 0.33005621284246445
        },
        {
          "epoch": 12,
          "train_loss": 0.32017567157745364,
          "val_loss": 0.32070498168468475
        },
        {
          "epoch": 13,
          "train_loss": 0.3205063879489899,
          "val_loss": 0.3306405171751976
        },
        {
          "epoch": 14,
          "train_loss": 0.30347222288449605,
          "val_loss": 0.32643377035856247
        },
        {
          "epoch": 15,
          "train_loss": 0.31402093172073364,
          "val_loss": 0.3434557840228081
        },
        {
          "epoch": 16,
          "train_loss": 0.33356040517489116,
          "val_loss": 0.33253733813762665
        },
        {
          "epoch": 17,
          "train_loss": 0.30152446528275806,
          "val_loss": 0.3243599161505699
        },
        {
          "epoch": 18,
          "train_loss": 0.31387523412704466,
          "val_loss": 0.32092446833848953
        },
        {
          "epoch": 19,
          "train_loss": 0.3158666789531708,
          "val_loss": 0.31659897416830063
        },
        {
          "epoch": 20,
          "train_loss": 0.3006204863389333,
          "val_loss": 0.33404727280139923
        },
        {
          "epoch": 21,
          "train_loss": 0.31900208393732704,
          "val_loss": 0.3644009307026863
        },
        {
          "epoch": 22,
          "train_loss": 0.30213626523812614,
          "val_loss": 0.3170173317193985
        },
        {
          "epoch": 23,
          "train_loss": 0.3247871776421865,
          "val_loss": 0.34023524075746536
        },
        {
          "epoch": 24,
          "train_loss": 0.2894282986720403,
          "val_loss": 0.3358498811721802
        },
        {
          "epoch": 25,
          "train_loss": 0.29039835929870605,
          "val_loss": 0.3320900723338127
        },
        {
          "epoch": 26,
          "train_loss": 0.286787203947703,
          "val_loss": 0.32560809701681137
        },
        {
          "epoch": 27,
          "train_loss": 0.29486482342084247,
          "val_loss": 0.3367571234703064
        },
        {
          "epoch": 28,
          "train_loss": 0.28832415441672005,
          "val_loss": 0.33401787281036377
        },
        {
          "epoch": 29,
          "train_loss": 0.2790981769561768,
          "val_loss": 0.31785835325717926
        },
        {
          "epoch": 30,
          "train_loss": 0.28359907269477846,
          "val_loss": 0.3316195011138916
        },
        {
          "epoch": 31,
          "train_loss": 0.281996746857961,
          "val_loss": 0.3162752836942673
        },
        {
          "epoch": 32,
          "train_loss": 0.28140958249568937,
          "val_loss": 0.33361730724573135
        },
        {
          "epoch": 33,
          "train_loss": 0.27323837677637736,
          "val_loss": 0.3267364576458931
        },
        {
          "epoch": 34,
          "train_loss": 0.28115304907162986,
          "val_loss": 0.33705422282218933
        },
        {
          "epoch": 35,
          "train_loss": 0.28302728533744814,
          "val_loss": 0.3306470438838005
        },
        {
          "epoch": 36,
          "train_loss": 0.2730355530977249,
          "val_loss": 0.3288782238960266
        },
        {
          "epoch": 37,
          "train_loss": 0.26369466284910836,
          "val_loss": 0.3353693410754204
        },
        {
          "epoch": 38,
          "train_loss": 0.25821926693121594,
          "val_loss": 0.3315736725926399
        },
        {
          "epoch": 39,
          "train_loss": 0.26917951305707294,
          "val_loss": 0.327772356569767
        },
        {
          "epoch": 40,
          "train_loss": 0.2598108579715093,
          "val_loss": 0.3334685117006302
        },
        {
          "epoch": 41,
          "train_loss": 0.26313103139400484,
          "val_loss": 0.32682862132787704
        },
        {
          "epoch": 42,
          "train_loss": 0.2515968163808187,
          "val_loss": 0.3460027649998665
        },
        {
          "epoch": 43,
          "train_loss": 0.26869298617045084,
          "val_loss": 0.3445666953921318
        },
        {
          "epoch": 44,
          "train_loss": 0.25480962892373404,
          "val_loss": 0.3367838189005852
        },
        {
          "epoch": 45,
          "train_loss": 0.25050685107707976,
          "val_loss": 0.33752185851335526
        },
        {
          "epoch": 46,
          "train_loss": 0.2540071278810501,
          "val_loss": 0.3342764601111412
        }
      ],
      "model_path": "kfold_models\\fold_2_model_0.3163.pt"
    },
    {
      "fold": 3,
      "best_val_loss": 0.31020519509911537,
      "history": [
        {
          "epoch": 1,
          "train_loss": 0.8905999819437663,
          "val_loss": 0.381401963531971
        },
        {
          "epoch": 2,
          "train_loss": 0.34540129800637565,
          "val_loss": 0.41172368824481964
        },
        {
          "epoch": 3,
          "train_loss": 0.35008843541145324,
          "val_loss": 0.33251718431711197
        },
        {
          "epoch": 4,
          "train_loss": 0.32749305764834086,
          "val_loss": 0.374630868434906
        },
        {
          "epoch": 5,
          "train_loss": 0.31055924892425535,
          "val_loss": 0.3442952558398247
        },
        {
          "epoch": 6,
          "train_loss": 0.31730728050072987,
          "val_loss": 0.3182004764676094
        },
        {
          "epoch": 7,
          "train_loss": 0.3114097932974497,
          "val_loss": 0.3332298621535301
        },
        {
          "epoch": 8,
          "train_loss": 0.3224081228176753,
          "val_loss": 0.3266154006123543
        },
        {
          "epoch": 9,
          "train_loss": 0.31772581934928895,
          "val_loss": 0.3321055918931961
        },
        {
          "epoch": 10,
          "train_loss": 0.3335151791572571,
          "val_loss": 0.3289223909378052
        },
        {
          "epoch": 11,
          "train_loss": 0.3142258395751317,
          "val_loss": 0.3237770274281502
        },
        {
          "epoch": 12,
          "train_loss": 0.3101746668418249,
          "val_loss": 0.32574940100312233
        },
        {
          "epoch": 13,
          "train_loss": 0.31796064774195354,
          "val_loss": 0.313711017370224
        },
        {
          "epoch": 14,
          "train_loss": 0.299652162194252,
          "val_loss": 0.3273320160806179
        },
        {
          "epoch": 15,
          "train_loss": 0.29900251924991605,
          "val_loss": 0.3202211484313011
        },
        {
          "epoch": 16,
          "train_loss": 0.30499399105707803,
          "val_loss": 0.32897721230983734
        },
        {
          "epoch": 17,
          "train_loss": 0.3050573150316874,
          "val_loss": 0.3157973438501358
        },
        {
          "epoch": 18,
          "train_loss": 0.2938364058732986,
          "val_loss": 0.31706422567367554
        },
        {
          "epoch": 19,
          "train_loss": 0.2899820595979691,
          "val_loss": 0.31020519509911537
        },
        {
          "epoch": 20,
          "train_loss": 0.28472088277339935,
          "val_loss": 0.33881986141204834
        },
        {
          "epoch": 21,
          "train_loss": 0.2768914113442103,
          "val_loss": 0.34898246452212334
        },
        {
          "epoch": 22,
          "train_loss": 0.2693560838699341,
          "val_loss": 0.31960485503077507
        },
        {
          "epoch": 23,
          "train_loss": 0.3033458282550176,
          "val_loss": 0.34562642872333527
        },
        {
          "epoch": 24,
          "train_loss": 0.2841901352008184,
          "val_loss": 0.32487213239073753
        },
        {
          "epoch": 25,
          "train_loss": 0.27650885383288065,
          "val_loss": 0.3349751755595207
        },
        {
          "epoch": 26,
          "train_loss": 0.2688912789026896,
          "val_loss": 0.33191557973623276
        },
        {
          "epoch": 27,
          "train_loss": 0.2737805426120758,
          "val_loss": 0.32189491018652916
        },
        {
          "epoch": 28,
          "train_loss": 0.2724817047516505,
          "val_loss": 0.31989822536706924
        },
        {
          "epoch": 29,
          "train_loss": 0.26183049579461415,
          "val_loss": 0.31625183671712875
        },
        {
          "epoch": 30,
          "train_loss": 0.25761348704497017,
          "val_loss": 0.32026343792676926
        },
        {
          "epoch": 31,
          "train_loss": 0.2633308897415797,
          "val_loss": 0.32134848088026047
        },
        {
          "epoch": 32,
          "train_loss": 0.255553079644839,
          "val_loss": 0.32350023835897446
        },
        {
          "epoch": 33,
          "train_loss": 0.2584928701321284,
          "val_loss": 0.3197726234793663
        },
        {
          "epoch": 34,
          "train_loss": 0.2558572898308436,
          "val_loss": 0.31451762467622757
        }
      ],
      "model_path": "kfold_models\\fold_3_model_0.3102.pt"
    },
    {
      "fold": 4,
      "best_val_loss": 0.2469698302447796,
      "history": [
        {
          "epoch": 1,
          "train_loss": 0.7583851893742879,
          "val_loss": 0.2722610980272293
        },
        {
          "epoch": 2,
          "train_loss": 0.3561293363571167,
          "val_loss": 0.28870758414268494
        },
        {
          "epoch": 3,
          "train_loss": 0.33602608839670817,
          "val_loss": 0.28540321439504623
        },
        {
          "epoch": 4,
          "train_loss": 0.3425159732500712,
          "val_loss": 0.27323925867676735
        },
        {
          "epoch": 5,
          "train_loss": 0.335814905166626,
          "val_loss": 0.27487359568476677
        },
        {
          "epoch": 6,
          "train_loss": 0.32939520875612893,
          "val_loss": 0.25492773205041885
        },
        {
          "epoch": 7,
          "train_loss": 0.3318034698565801,
          "val_loss": 0.24804320186376572
        },
        {
          "epoch": 8,
          "train_loss": 0.3227032870054245,
          "val_loss": 0.25064392760396004
        },
        {
          "epoch": 9,
          "train_loss": 0.3317448139190674,
          "val_loss": 0.24969226866960526
        },
        {
          "epoch": 10,
          "train_loss": 0.3252141147851944,
          "val_loss": 0.26823150366544724
        },
        {
          "epoch": 11,
          "train_loss": 0.31923771699269615,
          "val_loss": 0.37824756652116776
        },
        {
          "epoch": 12,
          "train_loss": 0.31103602151076,
          "val_loss": 0.25187182798981667
        },
        {
          "epoch": 13,
          "train_loss": 0.30860289732615154,
          "val_loss": 0.25571880489587784
        },
        {
          "epoch": 14,
          "train_loss": 0.31103360454241435,
          "val_loss": 0.26033565029501915
        },
        {
          "epoch": 15,
          "train_loss": 0.31074162423610685,
          "val_loss": 0.2555929683148861
        },
        {
          "epoch": 16,
          "train_loss": 0.2904418061176936,
          "val_loss": 0.2555246017873287
        },
        {
          "epoch": 17,
          "train_loss": 0.28599341015021007,
          "val_loss": 0.2712981328368187
        },
        {
          "epoch": 18,
          "train_loss": 0.2903643121321996,
          "val_loss": 0.26876186206936836
        },
        {
          "epoch": 19,
          "train_loss": 0.2796802639961243,
          "val_loss": 0.2706594280898571
        },
        {
          "epoch": 20,
          "train_loss": 0.2904333174228668,
          "val_loss": 0.27066198736429214
        },
        {
          "epoch": 21,
          "train_loss": 0.2704357415437698,
          "val_loss": 0.25340066105127335
        },
        {
          "epoch": 22,
          "train_loss": 0.2590270678202311,
          "val_loss": 0.2469698302447796
        },
        {
          "epoch": 23,
          "train_loss": 0.2578624695539474,
          "val_loss": 0.28691086918115616
        },
        {
          "epoch": 24,
          "train_loss": 0.26295213599999745,
          "val_loss": 0.269782230257988
        },
        {
          "epoch": 25,
          "train_loss": 0.2583281477292379,
          "val_loss": 0.27091384679079056
        },
        {
          "epoch": 26,
          "train_loss": 0.246919180949529,
          "val_loss": 0.29082074016332626
        },
        {
          "epoch": 27,
          "train_loss": 0.2416175921758016,
          "val_loss": 0.29052823781967163
        },
        {
          "epoch": 28,
          "train_loss": 0.23672736485799153,
          "val_loss": 0.28650737553834915
        },
        {
          "epoch": 29,
          "train_loss": 0.23861906925837198,
          "val_loss": 0.2763379216194153
        },
        {
          "epoch": 30,
          "train_loss": 0.2291561742623647,
          "val_loss": 0.2963792085647583
        },
        {
          "epoch": 31,
          "train_loss": 0.22422979275385538,
          "val_loss": 0.30248939990997314
        },
        {
          "epoch": 32,
          "train_loss": 0.2203381299972534,
          "val_loss": 0.29938480257987976
        },
        {
          "epoch": 33,
          "train_loss": 0.21828032930692037,
          "val_loss": 0.30027923732995987
        },
        {
          "epoch": 34,
          "train_loss": 0.21418334742387135,
          "val_loss": 0.3007710203528404
        },
        {
          "epoch": 35,
          "train_loss": 0.21328784823417662,
          "val_loss": 0.3005514368414879
        },
        {
          "epoch": 36,
          "train_loss": 0.20903858542442322,
          "val_loss": 0.30110087245702744
        },
        {
          "epoch": 37,
          "train_loss": 0.2063356767098109,
          "val_loss": 0.3116990402340889
        }
      ],
      "model_path": "kfold_models\\fold_4_model_0.2470.pt"
    },
    {
      "fold": 5,
      "best_val_loss": 0.29065652936697006,
      "history": [
        {
          "epoch": 1,
          "train_loss": 0.8612084050973257,
          "val_loss": 0.4791340306401253
        },
        {
          "epoch": 2,
          "train_loss": 0.3555693248907725,
          "val_loss": 0.321032389998436
        },
        {
          "epoch": 3,
          "train_loss": 0.3489856998125712,
          "val_loss": 0.3122634217143059
        },
        {
          "epoch": 4,
          "train_loss": 0.3278888682524363,
          "val_loss": 0.29065652936697006
        },
        {
          "epoch": 5,
          "train_loss": 0.3305855989456177,
          "val_loss": 0.29743074625730515
        },
        {
          "epoch": 6,
          "train_loss": 0.3212753345568975,
          "val_loss": 0.34023935347795486
        },
        {
          "epoch": 7,
          "train_loss": 0.3236343741416931,
          "val_loss": 0.310176819562912
        },
        {
          "epoch": 8,
          "train_loss": 0.3232884724934896,
          "val_loss": 0.3136380538344383
        },
        {
          "epoch": 9,
          "train_loss": 0.30619543194770815,
          "val_loss": 0.3059272766113281
        },
        {
          "epoch": 10,
          "train_loss": 0.3043853133916855,
          "val_loss": 0.3129800260066986
        },
        {
          "epoch": 11,
          "train_loss": 0.31970214446385703,
          "val_loss": 0.3451375737786293
        },
        {
          "epoch": 12,
          "train_loss": 0.3201665759086609,
          "val_loss": 0.31715601682662964
        },
        {
          "epoch": 13,
          "train_loss": 0.3055187543233236,
          "val_loss": 0.30465634912252426
        },
        {
          "epoch": 14,
          "train_loss": 0.2987236072619756,
          "val_loss": 0.3006094992160797
        },
        {
          "epoch": 15,
          "train_loss": 0.3013690968354543,
          "val_loss": 0.30872582644224167
        },
        {
          "epoch": 16,
          "train_loss": 0.28581497371196746,
          "val_loss": 0.3025691732764244
        },
        {
          "epoch": 17,
          "train_loss": 0.27602913876374563,
          "val_loss": 0.31211651861667633
        },
        {
          "epoch": 18,
          "train_loss": 0.2687648276487986,
          "val_loss": 0.3151029720902443
        },
        {
          "epoch": 19,
          "train_loss": 0.2810345451037089,
          "val_loss": 0.3232572600245476
        }
      ],
      "model_path": "kfold_models\\fold_5_model_0.2907.pt"
    }
  ],
  "model_paths": [
    "kfold_models\\fold_1_model_0.3080.pt",
    "kfold_models\\fold_2_model_0.3163.pt",
    "kfold_models\\fold_3_model_0.3102.pt",
    "kfold_models\\fold_4_model_0.2470.pt",
    "kfold_models\\fold_5_model_0.2907.pt"
  ]
}